---
title: "mathml: Translate R expressions to MathML"
author: "Matthias Gondan (Department of Psychology, University of Innsbruck, Austria)"
date: "2022-04-28"
bibliography: bibliography.bibtex
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rolog}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
options(rmarkdown.html_vignette.check_title=FALSE)
library(DiagrammeR)
library(DiagrammeRsvg)
library(htmltools)
```

  Matthias Gondan\
  Department of Psychology\
  University of Innsbruck\
  Innrain 9\
  A-6020 Innsbruck\
  Matthias.Gondan-Rochon@uibk.ac.at
  
# Abstract

123

## Keywords

HTML; MathML; R

# 1. mathml: Translate R expressions to MathML

The R extension of the markdown language [@Xie2020] enables reproducible
statistical reports with nice typesetting in HTML, Microsoft Word, and Latex.
However, so far, R expressions such as `pbinom(k, N, p)` are typeset as-is; 
prettier mathematical expressions such as $P_\mathrm{Bi}(X \le k; N, p)$ require
Latex commands like `P_\mathrm{Bi}\left(X \le k; N, p\right)`, which are
cumbersome to type in and hard to read even if the expressions are simple.
Since recently, manual pages include support for mathematical 
expressions [@Sarkar2022], which already is a big improvement.

Below Prolog's grammar rules are used for an _automatic_ translation of R
expressions to MathML. The result can then be used for calculations or it can be
rendered on a web page. A limited set of rules for translation from R to MathML
is found in `pl/mathml.pl` of the rolog package. The relevant code snippets are
shown in the listings below, along with their output.

```{r, results="asis"}
library(mathml)

term <- quote(pbinom(k, N, p))
mathml(term)

# Do some calculations with the same term
k = 10
N = 22
p = 0.4
eval(term)

catmath <- function(term)
{
	mathml(substitute(term))
}
```

# Package base

```{r, results="asis"}
catmath(abs(x))
catmath(sqrt(2L))

catmath(sin(pi/2L))
catmath(cos(pi/2L))
catmath(tan(pi/2L))

catmath(asin(1L/2L * sqrt(2L)))
catmath(acos(1L/2L * sqrt(2L)))
catmath(atan(1L/2L * sqrt(2L)))
catmath(atan2(1L, sqrt(3L)))

catmath(sinpi(2L))
catmath(cospi(2L))
catmath(tanpi(2L))

catmath(sinh(x))
catmath(cosh(x))
catmath(tanh(x))

catmath(asinh(x))
catmath(acosh(x))
catmath(atanh(x))

catmath(all(x))
catmath(any(x))

catmath(besselI(x, nu))
catmath(besselK(x, nu))
catmath(besselJ(x, nu))
catmath(besselY(x, nu))

catmath(beta(a, b))
catmath(lbeta(a, b))

catmath(gamma(x))
catmath(lgamma(x))

# catmath(psigamma(x, deriv = 0))
catmath(digamma(x))
catmath(trigamma(x))

catmath(choose(n, k))
catmath(lchoose(n, k))
catmath(factorial(x))
catmath(lfactorial(x))

catmath(and(a, b))
catmath(or(a, b))
catmath(!a)
catmath(xor(a, b))

catmath(exp(2L*pi*i))
catmath(expm1(2L*pi*i))
```

# References
