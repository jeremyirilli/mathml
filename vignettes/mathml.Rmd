---
title: "mathml: Translate R expressions to MathML"
author: "Matthias Gondan (Department of Psychology, University of Innsbruck, Austria)"
date: "2022-04-28"
bibliography: bibliography.bibtex
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rolog}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
options(rmarkdown.html_vignette.check_title=FALSE)
library(DiagrammeR)
library(DiagrammeRsvg)
library(htmltools)
```

  Matthias Gondan\
  Department of Psychology\
  University of Innsbruck\
  Innrain 9\
  A-6020 Innsbruck\
  Matthias.Gondan-Rochon@uibk.ac.at
  
# Abstract

123

## Keywords

HTML; MathML; R

# 1. mathml: Translate R expressions to MathML

The R extension of the markdown language [@Xie2020] enables reproducible
statistical reports with nice typesetting in HTML, Microsoft Word, and Latex.
However, so far, R expressions such as `pbinom(k, N, p)` are typeset as-is; 
prettier mathematical expressions such as $P_\mathrm{Bi}(X \le k; N, p)$ require
Latex commands like `P_\mathrm{Bi}\left(X \le k; N, p\right)`, which are
cumbersome to type in and hard to read even if the expressions are simple.
Since recently, manual pages include support for mathematical 
expressions [@Sarkar2022], which already is a big improvement.

Below Prolog's grammar rules are used for an _automatic_ translation of R
expressions to MathML. The result can then be used for calculations or it can be
rendered on a web page. A limited set of rules for translation from R to MathML
is found in `pl/mathml.pl` of the rolog package. The relevant code snippets are
shown in the listings below, along with their output.

```{r, results="asis"}
library(mathml)

term <- quote(pbinom(k, N, p))
mathml(term)

# Do some calculations with the same term
k = 10
N = 22
p = 0.4
eval(term)
```

# Package base

```{r, results="asis"}
mathml(quote(abs(x)))
mathml(quote(sqrt(2L)))

mathml(quote(sin(pi/2L)))
mathml(quote(cos(pi/2L)))
mathml(quote(tan(pi/2L)))

mathml(quote(asin(1L/2L * sqrt(2L))))
mathml(quote(acos(1L/2L * sqrt(2L))))
mathml(quote(atan(1L/2L * sqrt(2L))))
mathml(quote(atan2(1L, sqrt(3L))))

mathml(quote(sinpi(2L)))
mathml(quote(cospi(2L)))
mathml(quote(tanpi(2L)))

mathml(quote(sinh(x)))
mathml(quote(cosh(x)))
mathml(quote(tanh(x)))

mathml(quote(asinh(x)))
mathml(quote(acosh(x)))
mathml(quote(atanh(x)))

mathml(quote(all(x)))
mathml(quote(any(x)))

mathml(quote(besselI(x, nu)))
mathml(quote(besselK(x, nu)))
mathml(quote(besselJ(x, nu)))
mathml(quote(besselY(x, nu)))

# todo: catmath mit non-standard evaluation
```

# References
